# deploy.yml

---
- name: Exchange Keys between servers
  hosts: instance-1
  tasks:
    - name: SSH KeyGen command
      tags: run
      shell: > 
        ssh-keygen -q -b 2048 -t rsa -N "" -C "creating SSH" -f ~/.ssh/id_rsa
        creates="~/.ssh/id_rsa"

- name: Fetch the keyfile from the node to master
  tags: run
  fetch: 
    csrc: "~/.ssh/id_rsa.pub"
    dest: "buffer/{{ansible_hostname}}-id_rsa.pub"
    flat: yes
